make -f /Users/briancullinan/morpheus/Makefile --dry-run --keep-going --print-directory
make: Entering directory `/Users/briancullinan/morpheus'
/Applications/Xcode.app/Contents/Developer/usr/bin/make V= multigame \
 
		plugin index build-tools \
		BUILD_DIR="build/release-wasm-js" \
		CFLAGS="" \
		LDFLAGS=""
 
make[1]: Entering directory `/Users/briancullinan/morpheus'
make[1]: Nothing to be done for `multigame'.
if [ ! -d "./build/release-wasm-js" ]; then mkdir -p "./build/release-wasm-js";fi;
 
if [ ! -d "./build/release-wasm-js/plugin" ]; then mkdir -p "./build/release-wasm-js/plugin";fi;
 
cat driver/library/eval/body.js driver/library/eval/call.js driver/library/eval/loop.js driver/library/eval/prim.js driver/library/eval/vars.js  driver/utils/acorn.js driver/utils/acorn-loose.js driver/utils/crypt.js driver/utils/jsencrypt.js > build/release-wasm-js/plugin/backend.js
cat driver/utils/jsencrypt.js driver/utils/crypt.js driver/utils/keymaster.js > build/release-wasm-js/plugin/frontend.js
:
cp driver/manifest.json build/release-wasm-js/plugin/manifest.json
cp driver/rules.json build/release-wasm-js/plugin/rules.json
cp engine/wasm/http/index.html build/release-wasm-js/plugin/index.html
cp engine/wasm/http/redpill.png build/release-wasm-js/plugin/redpill.png
:
 
if [ ! -d "./build/release-wasm-js/ded" ]; then mkdir -p "./build/release-wasm-js/ded";fi;
 
echo "WASM-LD morph.ded.wasm"
libs/darwin/wasi-sdk-14.0/bin/clang -o build/release-wasm-js/morph.ded.wasm build/release-wasm-js/ded/be_aas_bspq3.o build/release-wasm-js/ded/be_aas_cluster.o build/release-wasm-js/ded/be_aas_debug.o build/release-wasm-js/ded/be_aas_entity.o build/release-wasm-js/ded/be_aas_file.o build/release-wasm-js/ded/be_aas_main.o build/release-wasm-js/ded/be_aas_move.o build/release-wasm-js/ded/be_aas_optimize.o build/release-wasm-js/ded/be_aas_reach.o build/release-wasm-js/ded/be_aas_route.o build/release-wasm-js/ded/be_aas_routealt.o build/release-wasm-js/ded/be_aas_sample.o build/release-wasm-js/ded/be_ai_char.o build/release-wasm-js/ded/be_ai_chat.o build/release-wasm-js/ded/be_ai_gen.o build/release-wasm-js/ded/be_ai_goal.o build/release-wasm-js/ded/be_ai_move.o build/release-wasm-js/ded/be_ai_weap.o build/release-wasm-js/ded/be_ai_weight.o build/release-wasm-js/ded/be_ea.o build/release-wasm-js/ded/be_interface.o build/release-wasm-js/ded/l_crc.o build/release-wasm-js/ded/l_libvar.o build/release-wasm-js/ded/l_log.o build/release-wasm-js/ded/l_memory.o build/release-wasm-js/ded/l_precomp.o build/release-wasm-js/ded/l_script.o build/release-wasm-js/ded/l_struct.o build/release-wasm-js/ded/cm_load.o build/release-wasm-js/ded/cm_patch.o build/release-wasm-js/ded/cm_polylib.o build/release-wasm-js/ded/cm_test.o build/release-wasm-js/ded/cm_trace.o build/release-wasm-js/ded/cmd.o build/release-wasm-js/ded/cmd_descriptions.o build/release-wasm-js/ded/common.o build/release-wasm-js/ded/cvar.o build/release-wasm-js/ded/cvar_descriptions.o build/release-wasm-js/ded/files.o build/release-wasm-js/ded/files_async.o build/release-wasm-js/ded/history.o build/release-wasm-js/ded/huffman.o build/release-wasm-js/ded/huffman_static.o build/release-wasm-js/ded/keys.o build/release-wasm-js/ded/md4.o build/release-wasm-js/ded/md5.o build/release-wasm-js/ded/msg.o build/release-wasm-js/ded/net_chan.o build/release-wasm-js/ded/net_ip.o build/release-wasm-js/ded/puff.o build/release-wasm-js/ded/q_math.o build/release-wasm-js/ded/q_shared.o build/release-wasm-js/ded/splines.o build/release-wasm-js/ded/unzip.o build/release-wasm-js/ded/vm.o build/release-wasm-js/ded/vm_interpreted.o build/release-wasm-js/ded/sv_bot.o build/release-wasm-js/ded/sv_bsp.o build/release-wasm-js/ded/sv_bsp_atlantis.o build/release-wasm-js/ded/sv_bsp_chutes.o build/release-wasm-js/ded/sv_bsp_cube.o build/release-wasm-js/ded/sv_bsp_maze.o build/release-wasm-js/ded/sv_bsp_mini.o build/release-wasm-js/ded/sv_bsp_monaco.o build/release-wasm-js/ded/sv_bsp_portals.o build/release-wasm-js/ded/sv_bsp_tools.o build/release-wasm-js/ded/sv_ccmds.o build/release-wasm-js/ded/sv_client.o build/release-wasm-js/ded/sv_demo_mv.o build/release-wasm-js/ded/sv_filter.o build/release-wasm-js/ded/sv_game.o build/release-wasm-js/ded/sv_init.o build/release-wasm-js/ded/sv_main.o build/release-wasm-js/ded/sv_net_chan.o build/release-wasm-js/ded/sv_snapshot.o build/release-wasm-js/ded/sv_world.o build/release-wasm-js/ded/sv_zip.o build/release-wasm-js/ded/sys_main.o  -Wl,--import-memory -Wl,--import-table -Wl,--export-dynamic -Wl,--error-limit=200 -Wl,--export=sprintf -Wl,--export=malloc -Wl,--export=stderr -Wl,--export=stdout -Wl,--export=errno --no-standard-libraries -Wl,--allow-undefined-file=engine/wasm/wasm.syms engine/wasm/wasi/libclang_rt.builtins-wasm32.a libs/wasi-sysroot/lib/wasm32-wasi/libc.a 
 
echo "OPT_CC build/release-wasm-js/morph.ded.wasm"
wasm-opt -Os --no-validation -o build/release-wasm-js/morph.ded.opt build/release-wasm-js/morph.ded.wasm
mv build/release-wasm-js/morph.ded.wasm build/release-wasm-js/morph.ded.wasm.bak 2> /dev/null
mv build/release-wasm-js/morph.ded.opt build/release-wasm-js/morph.ded.wasm 2> /dev/null
rm build/release-wasm-js/morph.ded.wasm.bak 2> /dev/null
: 
 
echo "\nglobalThis.window = globalThis;\n" > build/release-wasm-js/sys_worker.js
node -e "require('./engine/wasm/bin/make').normalFormatAll( \
		'build/release-wasm-js/sys_worker.js', 'driver/library', 'driver/library/', 'library/')"
node -e "console.log( \
		require('./driver/library/repl.js').doBootstrap + '\n' \
		+ require('./engine/wasm/sys_idbfs.js').readPreFS + '\n' \
		+ require('./engine/wasm/sys_idbfs.js')._base64ToArrayBuffer + '\n' \
		+ require('./driver/library/quine.js').installAsyncTriggerMiddleware + '\n' \
		+ require('./driver/library/quine.js').encryptedAccessorResponseMiddleware + '\n' \
		+ require('./driver/library/quine.js').workerMessageResponseMiddleware + '\n'  \
		+ require('./driver/library/quine.js').installAsyncTriggerMiddleware + '\n'  \
		+ require('./driver/library/quine.js').installEncryptedAsyncMiddleware \
		+ '\nworkerMessageResponseMiddleware();\n' );" >> build/release-wasm-js/sys_worker.js
cat driver/library/eval/body.js driver/library/eval/call.js driver/library/eval/loop.js driver/library/eval/prim.js driver/library/eval/vars.js driver/utils/acorn.js driver/utils/acorn-loose.js driver/utils/crypt.js driver/utils/jsencrypt.js driver/library/repl.js >> build/release-wasm-js/sys_worker.js
cp -r -f engine/wasm/http/index.html build/release-wasm-js/morph.html
cat driver/utils/jsencrypt.js driver/utils/crypt.js driver/utils/keymaster.js driver/library/sidebar.js driver/library/dom.js driver/library/iso.js engine/wasm/http/ace/ace.js engine/wasm/http/ace/mode-javascript.js engine/wasm/http/ace/theme-monokai.js engine/wasm/http/ace/theme-xcode.js engine/wasm/http/nipplejs.js engine/wasm/sys_cli.js engine/wasm/sys_emgl.js engine/wasm/sys_fs.js engine/wasm/sys_idbfs.js engine/wasm/sys_in.js engine/wasm/sys_net.js engine/wasm/sys_std.js engine/wasm/sys_web.js  > build/release-wasm-js/morph.js
node -e "require('./engine/wasm/bin/make').normalBootstrap( \
 
		'build/release-wasm-js/morph.html', 'build/release-wasm-js/morph.js')"
node -e "require('./engine/wasm/bin/make').normalReplace( \
		'build/release-wasm-js/morph.html', '\n'  \
		+ require('./driver/library/quine.js').emitDownload + '\n' \
		+ require('./driver/library/repl.js').onFrontend + '\n' \
		+ require('./driver/library/quine.js').installAsyncTriggerMiddleware + '\n' \
		+ require('./driver/library/quine.js').encryptedAccessorResponseMiddleware + '\n' \
		+ require('./driver/library/quine.js').domMessageResponseMiddleware + '\n' \
		+ require('./driver/library/quine.js').installEncryptedAsyncMiddleware \
		+ '\ndomMessageResponseMiddleware();\n' );"
node -e "require('./engine/wasm/bin/make').normalBase64( \
		'build/release-wasm-js/morph.html', 'build/release-wasm-js/sys_worker.js', 'sys_worker.js')"
cp build/release-wasm-js/morph.html index.html
:
make[1]: Leaving directory `/Users/briancullinan/morpheus'
 
make: Leaving directory `/Users/briancullinan/morpheus'
 
